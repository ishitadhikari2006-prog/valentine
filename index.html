<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Valentine Game</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:#fff;
  overflow:hidden;
  font-family:Arial,sans-serif;
}

/* GAME */
#game{
  position:relative;
  width:100vw;
  height:100vh;
  background:#fff;
  overflow:hidden;
}

/* JERRY */
#jerry{
  position:absolute;
  bottom:80px;
  left:60px;
  width:60px;
  height:60px;
}

/* OBSTACLE */
.obstacle{
  position:absolute;
  bottom:80px;
  width:40px;
  height:60px;
  background:#000;
}

/* TEXT */
#textBox{
  position:absolute;
  top:20%;
  width:100%;
  text-align:center;
  font-size:20px;
  display:none;
}

/* VIDEO */
#videoWrap{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  z-index:10;
}
#videoWrap video{
  width:100%;
  height:100%;
  object-fit:cover;
}
</style>
</head>

<body>

<div id="videoWrap">
  <video id="valVideo" playsinline>
    <source src="video.mp4" type="video/mp4">
  </video>
</div>

<div id="game">
  <img id="jerry" src="jerry.png">
  <div id="textBox">
    Do you now accept your bf is always right in every argument and wanna be his Valentine üòº‚ù§Ô∏è  
    <br><br>
    <button onclick="restart()">Restart</button>
  </div>
</div>

<script>
const game = document.getElementById("game");
const jerry = document.getElementById("jerry");
const videoWrap = document.getElementById("videoWrap");
const video = document.getElementById("valVideo");
const textBox = document.getElementById("textBox");

let y = 0;
let vy = 0;
let gravity = 0.18;   // üî• FIXED gravity so 4.5 works
let playing = true;
let obs;
let noCount = 0;

function createObstacle(){
  obs = document.createElement("div");
  obs.className = "obstacle";
  obs.style.right = "-40px";
  game.appendChild(obs);
}

createObstacle();

function loop(){
  if(!playing) return;

  // JUMP PHYSICS
  vy -= gravity;
  y += vy;
  if(y < 0){ y = 0; vy = 0; }

  jerry.style.bottom = 80 + y + "px";

  // OBSTACLE MOVE
  let x = obs.offsetLeft - 4;
  obs.style.left = x + "px";

  // COLLISION
  if(x < 110 && x > 40 && y < 62){
    endGame();
  }

  // RESET OBSTACLE
  if(x < -40){
    obs.style.left = "100vw";
  }

  requestAnimationFrame(loop);
}

loop();

// TAP TO JUMP
game.onclick = ()=>{
  if(playing && y === 0){
    vy = 4.5;   // ‚úÖ LOW jump that actually works
  }
};

function endGame(){
  playing = false;
  textBox.style.display = "block";
}

// VIDEO LOGIC (14th NO)
function tapNo(){
  noCount++;
  if(noCount === 14){
    videoWrap.style.display = "block";
    video.play();
    video.onended = ()=>{
      videoWrap.style.display = "none";
      startGame();
    };
  }
}

function startGame(){
  playing = true;
  y = 0; vy = 0;
  obs.style.left = "100vw";
  textBox.style.display = "none";
  loop();
}

function restart(){
  startGame();
}
</script>

</body>
</html>
